---
layout: default
description: Charts and stuff
---

<script src="{{ base_path }}vendor/jquery/jquery.js"></script>
<script src="{{ base_path }}vendor/moment/moment.js"></script>
<script src="{{ base_path }}vendor/underscore/underscore.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="{{ base_path }}vendor/js/bootstrap-sass/bootstrap.js"></script>
<script src="{{ base_path }}js/data.js"></script>


<div class="container-fluid">
	<div class="row metadata">
		<div class="col-xs-12 col-sm-1"><img src="{{ site.data.baby.picture_url }}"></div>
		<div class="col-xs-12 col-sm-11">
			<div class="row">
				<div class="col-md-12">{{ site.data.baby.name }}</div>
				<div class="col-md-12">{{ site.data.baby.birthdate }}</div>
				<div class="col-md-12">{{ site.data.baby.gender }}</div>
			</div>
		</div>
	</div>

	<div class="row kpis">
		<div class="col-xs-6 col-sm-3 kpi">
			<img src="{{ base_path }}assets/images/crib-toy.png" class="img-responsive" alt="Sleep">
			<h4><span id="sleepHoursKPI"></span> Hours</h4>
			<span class="text-muted">in peaceful sleep</span>
		</div>
		<div class="col-xs-6 col-sm-3 kpi">
			<img src="{{ base_path }}assets/images/feeding-bottle-1.png" alt="Feeding">
			<h4><span id="feedingsKPI"></span> Feedings</h4>
			<span class="text-muted">ingesting sustenance</span>
		</div>
		<div class="col-xs-6 col-sm-3 kpi">
			<img src="{{ base_path }}assets/images/diaper.png" alt="Diaper">
			<h4><span id="diapersKPI"></span> Diapers</h4>
			<span class="text-muted">dutifully changed</span>
		</div>
		<div class="col-xs-6 col-sm-3 kpi">
			<img src="{{ base_path }}assets/images/bathtub.png" class="img-responsive" alt="Bath">
			<h4><span id="bathsKPI"></span> Baths</h4>
			<span class="text-muted">getting squeaky clean</span>
		</div>
	</div>

	<div class="row">
		<h2>Recent Events</h2>
		<div id="timeline" class="google-chart"></div>
	</div>

	<div class="row">
		<h2>Night Sleeps</h2>
		<div id="daySleepChart" class="google-chart"></div>
	</div>

	<div class="row">
		<h2>Day Naps</h2>
		<div id="napsChart" class="google-chart"></div>
	</div>

	<div class="row">
		<h2>Total Sleep</h2>
		<div id="sleepChart" class="google-chart"></div>
	</div>

	<div class="row">
		<h2>Growth</h2>
		<div id="growthChart" class="google-chart"></div>
	</div>
</div>

<script type="text/javascript">
google.charts.load('current', {packages: ['corechart', 'timeline']});
google.charts.setOnLoadCallback(drawCharts);

var sleeps = new Sleeps({{ site.data.sleeps | jsonify }});
var feeds = new Feeds({{ site.data.feeds | jsonify }});
var excretions = new Excretions({{ site.data.excretions | jsonify }});
var journals = new Journals({{ site.data.journal_entries | jsonify }});
var growths = new Growths({{ site.data.growths | jsonify }});

$("#sleepHoursKPI").html(Math.round(sleeps.totalHours));
$("#feedingsKPI").html(feeds.data.length);
$("#diapersKPI").html(excretions.data.length);
$("#bathsKPI").html(_.where(journals.data, {type: "Bath"}).length);

function drawCharts() {
	var timelineStart = new Date();
	timelineStart.setDate(timelineStart.getDate() - 10); // 10 days ago
	var timelineData = new TimelineData({Sleep: sleeps, Feeds:feeds, Diapers:excretions, Journal:journals}, timelineStart);

	var timeline = new google.visualization.Timeline(document.getElementById('timeline'));
	timeline.draw(timelineData.dataTable, {timeline: {showBarLabels:false}});

	var daySleepChart = new google.visualization.SteppedAreaChart(document.getElementById('daySleepChart'));

	var longestSleepsDataTable = sleeps.longestDurationsDataTable();
	var longestNightSleepsDataView = new google.visualization.DataView(longestSleepsDataTable);
	// Filter to night sleeps and hide the column
	longestNightSleepsDataView.setRows(longestNightSleepsDataView.getFilteredRows([{column: 1, value: 'Night'}]));
	longestNightSleepsDataView.hideColumns([1]);
	daySleepChart.draw(longestNightSleepsDataView, {isStacked: true});

	var napsData = sleeps.dataView(['day', 'type', 'duration']);
	napsData.setRows(napsData.getFilteredRows([{column: 1, value: 'Nap'}]));
	napsData = google.visualization.data.group(napsData.toDataTable(), [0], [
		{column: 2, label: 'Duration', aggregation: google.visualization.data.sum, type: 'number'},
		{column: 2, label: 'Count', aggregation: google.visualization.data.count, type: 'number'}
	]);

	var napsChart = new google.visualization.ComboChart(document.getElementById('napsChart'));
	napsChart.draw(napsData, {
		seriesType: 'bars',
		series: {1: {type: 'line', targetAxisIndex: 1}}
    });

	var sleepData = sleeps.dataView(['day', 'duration']);
	sleepData = google.visualization.data.group(sleepData.toDataTable(), [0], [
		{column: 1, label: 'Duration', aggregation: google.visualization.data.sum, type: 'number'}
	]);

	var sleepChart = new google.visualization.ColumnChart(document.getElementById('sleepChart'));
	sleepChart.draw(sleepData);

	var growthChart = new google.visualization.LineChart(document.getElementById('growthChart'));
	var growthsDataView = growths.dataView(['day', 'weight', 'height', 'head']);
	var growthChartOptions = {
		curveType: 'function',
		interpolateNulls: true,
		series: {
			1: { targetAxisIndex:1 },
			2: { targetAxisIndex:1 }
		},
		vAxes: {
			0: { title: growths.weightUnit()},
			1: { title: growths.lengthUnit()}
		}
	};
	growthChart.draw(growthsDataView, growthChartOptions);
}

$(window).resize(drawCharts);

</script>
