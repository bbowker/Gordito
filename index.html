---
layout: default
description: Charts and stuff
---

<script src="{{ base_path }}vendor/moment/moment.js"></script>
<script src="{{ base_path }}vendor/underscore/underscore.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="{{ base_path }}js/data.js"></script>

<h2>Recent Events</h2>
<div id="timeline" class="google-chart"></div>

<h2>Night Sleeps</h2>
<div id="daySleepChart" class="google-chart"></div>

<h2>Day Naps</h2>
<div id="napsChart" class="google-chart"></div>

<h2>Total Sleep</h2>
<div id="sleepChart" class="google-chart"></div>

<h2>Growth</h2>
<div id="growthChart" class="google-chart"></div>


<script type="text/javascript">
google.charts.load('current', {packages: ['corechart', 'timeline']});
google.charts.setOnLoadCallback(drawCharts);


function drawCharts() {
	var sleeps = new Sleeps({{ site.data.sleeps | jsonify }});
	var feeds = new Feeds({{ site.data.feeds | jsonify }});
	var excretions = new Excretions({{ site.data.excretions | jsonify }});
	var journals = new Journals({{ site.data.journal_entries | jsonify }});
	var growths = new Growths({{ site.data.growths | jsonify }});

	var timelineStart = new Date();
	timelineStart.setDate(timelineStart.getDate() - 10); // 10 days ago
	var timelineData = new TimelineData({Sleep: sleeps, Feeds:feeds, Diapers:excretions, Journal:journals}, timelineStart);

	var timeline = new google.visualization.Timeline(document.getElementById('timeline'));
	timeline.draw(timelineData.dataTable, {timeline: {showBarLabels:false}});

	var daySleepChart = new google.visualization.SteppedAreaChart(document.getElementById('daySleepChart'));

	var longestSleepsDataTable = sleeps.longestDurationsDataTable();
	var longestNightSleepsDataView = new google.visualization.DataView(longestSleepsDataTable);
	// Filter to night sleeps and hide the column
	longestNightSleepsDataView.setRows(longestNightSleepsDataView.getFilteredRows([{column: 1, value: 'Night'}]));
	longestNightSleepsDataView.hideColumns([1]);
	daySleepChart.draw(longestNightSleepsDataView, {isStacked: true});

	var napsData = sleeps.dataView(['day', 'type', 'duration']);
	napsData.setRows(napsData.getFilteredRows([{column: 1, value: 'Nap'}]));
	napsData = google.visualization.data.group(napsData.toDataTable(), [0], [
		{column: 2, label: 'Duration', aggregation: google.visualization.data.sum, type: 'number'},
		{column: 2, label: 'Count', aggregation: google.visualization.data.count, type: 'number'}
	]);

	var napsChart = new google.visualization.ComboChart(document.getElementById('napsChart'));
	napsChart.draw(napsData, {
		seriesType: 'bars',
		series: {1: {type: 'line', targetAxisIndex: 1}}
    });

	var sleepData = sleeps.dataView(['day', 'duration']);
	sleepData = google.visualization.data.group(sleepData.toDataTable(), [0], [
		{column: 1, label: 'Duration', aggregation: google.visualization.data.sum, type: 'number'}
	]);

	var sleepChart = new google.visualization.ColumnChart(document.getElementById('sleepChart'));
	sleepChart.draw(sleepData);

	var growthChart = new google.visualization.LineChart(document.getElementById('growthChart'));
	var growthsDataView = growths.dataView(['day', 'weight', 'height', 'head']);
	var growthChartOptions = {
		curveType: 'function',
		interpolateNulls: true,
		series: {
			1: { targetAxisIndex:1 },
			2: { targetAxisIndex:1 }
		},
		vAxes: {
			0: { title: growths.weightUnit()},
			1: { title: growths.lengthUnit()}
		}
	};
	growthChart.draw(growthsDataView, growthChartOptions);
}

</script>
