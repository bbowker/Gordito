---
layout: default
description: Charts and stuff
---

<script src="{{ base_path }}vendor/moment/moment.js"></script>
<script src="{{ base_path }}vendor/underscore/underscore.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="{{ base_path }}js/data.js"></script>

<style>
code {
    color: #007000;
}
.google-chart {
    height: 300px;
    width: 1200px;
}
</style>

<h2>Latest Sleeps</h2>
<div id="sleepTimeline" class="google-chart"></div>

<h2>Night Sleeps</h2>
<div id="sleepChart" class="google-chart"></div>

<script type="text/javascript">
google.charts.load('current', {packages: ['corechart', 'timeline']});
google.charts.setOnLoadCallback(drawCharts);


function drawCharts() {
    var sleeps = new Sleeps({{ site.data.sleeps | jsonify }});

    var sleepTimeline = new google.visualization.Timeline(document.getElementById('sleepTimeline'));
    var sleepTimelineView = sleeps.dataView([
        'type',
        {sourceColumn: 'note', role: 'tooltip'},
        'start',
        'end'
    ]);

    // Filter to last 10 days
    var timelineStart = new Date();
    timelineStart.setDate(timelineStart.getDate() - 10); // 10 days ago
    sleepTimelineView.setRows(sleepTimelineView.getFilteredRows([{column: 2, minValue: timelineStart}]));
    sleepTimeline.draw(sleepTimelineView);

    var sleepChart = new google.visualization.SteppedAreaChart(document.getElementById('sleepChart'));

    var longestSleepsDataTable = sleeps.longestDurationsDataTable();
    var longestNightSleepsDataView = new google.visualization.DataView(longestSleepsDataTable);
    // Filter to night sleeps and hide the column
    longestNightSleepsDataView.setRows(longestNightSleepsDataView.getFilteredRows([{column: 1, value: 'Night Sleep'}]));
    longestNightSleepsDataView.hideColumns([1]);
    sleepChart.draw(longestNightSleepsDataView, {isStacked: true});
}

</script>
